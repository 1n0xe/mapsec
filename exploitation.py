# exploitation.py

def run_exploitation():
    print("Calcul des possibilités d'exploitation...")

    # Étape 1 : Demander les ports trouvés précédemment
    input_ports = input("Entrez les ports trouvés précédemment (séparés par des virgules) : ")
    ports = [int(port.strip()) for port in input_ports.split(",")]

    # Étape 2 : Résultats personnalisés pour les ports les plus utilisés
    print("Analyse des chemins d'attaque pour les ports trouvés :")
    for port in ports:
        if port in common_ports:
            vulnerabilities = get_vulnerabilities(port)
            print(f"\nPort {port} - Exploitations potentielles :\n\n{', '.join(vulnerabilities)}")
        else:
            print(f"\nPort {port} - Pas d'exploitations' connue")

    print("Recherche de chemins d'attaque terminée.")
    input("Appuyez sur Entrée pour continuer...")  # Attendre l'entrée de l'utilisateur

# Liste des ports courants lors d'un pentest
common_ports = [21, 22, 23, 25, 53, 80, 110, 139, 443, 445, 3389, 8080, 3306, 1433, 1521, 5900, 5432, 6379, 27017, 11211]

# Fonction pour obtenir les vulnérabilités potentielles d'un port donné (pour l'exemple)
def get_vulnerabilities(port):
    vulnerabilities = {
        21: [
            "Accès anonyme activé posible\n"
            "Dépassement de tampon possible\n"
            "Attaque de type 'bounce' possible\n"
            "Attaque par force brute possible (Hydra)\n"
            "Vulnérabilité FTP (Metasploit)\n"
        ],
        22: [
            "Authentification par mot de passe activée\n"
            "Exposition de clés publiques\n"
            "Attaque de type 'brute force' possible (Hydra)\n"
            "Configuration obsolète du chiffrement\n"
            "Vulnérabilité SSH (Metasploit)\n"
        ],
        23: [
            "Faible sécurité des mots de passe\n"
            "Fuites d'informations lors de l'authentification\n"
            "Attaque par force brute possible\n"
            "Commande d'exécution à distance possible\n"
            "Vulnérabilité Telnet\n"
        ],
        25: [
            "Possible relais de courrier non autorisé\n"
            "Attaque de type 'spoofing' possible\n"
            "Vulnérabilité SMTP\n"
            "Attaque de type 'brute force' sur les comptes\n"
            "Fuites d'informations possibles\n"
        ],
        53: [
            "Amplification DNS possible\n"
            "Vulnérabilité de débordement de tampon possible\n"
            "Attaque par empoisonnement du cache possible\n"
            "Exposition de détails du serveur\n"
            "Vulnérabilité DNS\n"
        ],
        80: [
            "Attaque de CMS possible (WPscan)\n"
            "Exposition du contenu du répertoire parent\n"
            "Injection SQL possible (Sqlmap)\n"
            "Vulnérabilité XSS possible (XSStrike)\n"
            "Vulnérabilité HTTP (Metasploit)\n"
        ],
        110: [
            "Authentification faible\n"
            "Fuites d'informations sensibles\n"
            "Attaque de type 'brute force' sur les comptes\n"
            "Vulnérabilité de sécurité POP3\n"
            "Exposition des détails du serveur\n"
        ],
        139: [
            "Exposition de partages de fichiers sensibles\n"
            "Possible attaque de type 'relay'\n"
            "Vulnérabilité de sécurité NetBIOS\n"
            "Exposition des informations du système\n"
            "Attaque par force brute possible\n"
        ],
        443: [
            "Certificat expiré\n"
            "Attaque de renégociation possible\n"
            "Protocoles faibles activés\n"
            "Attaque DROWN possible\n"
            "Vulnérabilité SSL/TLS possible\n"
        ],
        445: [
            "Partages SMB non sécurisés\n"
            "Possible attaque de type 'relay'\n"
            "Attaque d'injection MS17-010 possible\n"
            "Vulnérabilité SMBGhost possible\n"
            "Vulnérabilité SMB\n"
        ],
        3389: [
            "Attaque de type 'brute force' sur les comptes\n"
            "Fuites d'informations possibles\n"
            "Possibilité de déni de service\n"
            "Vulnérabilité RDP\n"
            "Exposition des détails du serveur\n"
        ],
        8080: [
            "Accès non sécurisé à l'interface d'administration\n"
            "Possibilité de cross-site scripting (XSS)\n"
            "Possibilité de falsification de requête intersite (CSRF)\n"
            "Vulnérabilité de sécurité sur l'application web\n"
            "Exposition des détails du serveur\n"
        ],
        3306: [
            "Configuration faible du mot de passe de la base de données\n"
            "Vulnérabilité SQL Injection possible\n"
            "Vulnérabilité de sécurité de la base de données\n"
            "Exposition des détails du serveur\n"
            "Fuites d'informations sensibles\n"
        ],
        1433: [
            "Configuration faible du mot de passe de la base de données\n"
            "Vulnérabilité SQL Injection possible\n"
            "Vulnérabilité de sécurité de la base de données\n"
            "Exposition des détails du serveur\n"
            "Fuites d'informations sensibles\n"
        ],
        1521: [
            "Configuration faible du mot de passe de la base de données\n"
            "Vulnérabilité de sécurité de la base de données\n"
            "Exposition des détails du serveur\n"
            "Attaque par débordement possible\n"
            "Fuites d'informations sensibles\n"
        ],
        5900: [
            "Pas de mot de passe de protection\n"
            "Attaque d'authentification brute VNC possible\n"
            "Vulnérabilité de sécurité VNC\n"
            "Exposition des détails du serveur\n"
            "Attaque par débordement possible\n"
        ],
        5432: [
            "Configuration faible du mot de passe de la base de données\n"
            "Vulnérabilité SQL Injection possible\n"
            "Vulnérabilité de sécurité de la base de données\n"
            "Exposition des détails du serveur\n"
            "Fuites d'informations sensibles\n"
        ],
        6379: [
            "Accès non sécurisé à la base de données NoSQL\n"
            "Vulnérabilité d'injection de commande possible\n"
            "Exposition des détails du serveur\n"
            "Fuites d'informations sensibles\n"
            "Attaque par débordement possible\n"
        ],
        27017: [
            "Pas de mot de passe de protection\n"
            "Configuration faible du mot de passe de la base de données\n"
            "Vulnérabilité d'injection de commande possible\n"
            "Exposition des détails du serveur\n"
            "Fuites d'informations sensibles\n"
        ],
        11211: [
            "Accès non sécurisé au cache Memcached\n"
            "Amplification d'attaques DDoS possibles\n"
            "Exposition des détails du serveur\n"
            "Fuites d'informations sensibles\n"
            "Attaque par débordement possible\n"
        ]
    }
    return vulnerabilities.get(port, [])
